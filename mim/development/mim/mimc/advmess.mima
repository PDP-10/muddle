
<PACKAGE "ADVMESS">

<ENTRY VMESS ANA-MESS ADDVMESS COMPILE-ERROR COMPILE-LOSSAGE COMPILE-WARNING COMPILE-NOTE COMPILE-ACTIVATION>

<USE "NPRINT" "COMPDEC">

#WORD *4565744001*
		    <GFCN VMESS ("VALUE" ATOM "TUPLE" TUPLE)>
		    <MAKTUP MSG4 O20 = MSG4>
		    <INTGO>
		    <FRAME 'PRINC>
		    <PUSH "===== ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <CHTYPE MSG4 <TYPE-CODE VECTOR> = MSG4>
		    <LOOP>
MAP10
		    <INTGO>
		    <EMPUV? MSG4 + MAPAP13>
		    <NTHUV MSG4 1 = O20>
		    <TYPE? O20 <TYPE-CODE STRING> - PHRASE22>
		    <FRAME 'PRINC>
		    <PUSH O20>
		    <DEAD O20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <JUMP + PHRASE27>
PHRASE22
		    <FRAME 'PRIN1>
		    <PUSH O20>
		    <DEAD O20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2>
PHRASE27
		    <RESTUV MSG4 1 = MSG4 (TYPE VECTOR)>
		    <JUMP + MAP10>
MAPAP13
		    <FRAME 'CRLF>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'CRLF 1 = MSG4>
		    <RETURN MSG4>
		    <DEAD MSG4>
		    <END VMESS>

#WORD *20431271265*
		    <GFCN ANA-MESS ("VALUE" ATOM <LIST ANY [REST NODE LIST]>) L4>
		    <TEMP LL8 TEMP13 O28>
		    <INTGO>
		    <RESTL L4 1 = LL8 (TYPE LIST)>
		    <DEAD L4>
		    <LOOP>
AGAIN9
		    <INTGO>
		    <EMPL? LL8 - PHRASE11 (TYPE LIST)>
		    <RETURN 'T>
PHRASE11
		    <FRAME 'PRINC>
		    <PUSH "===== ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <RESTL LL8 1 = TEMP13 (TYPE LIST)>
		    <NTHL TEMP13 1 = TEMP13 (TYPE LIST)>
		    <LOOP>
MAP17
		    <INTGO>
		    <EMPL? TEMP13 + MAPAP20>
		    <NTHL TEMP13 1 = O28>
		    <TYPE? O28 <TYPE-CODE NODE> - PHRASE30>
		    <FRAME 'NODE-COMPLAIN>
		    <PUSH O28>
		    <DEAD O28>
		    <CALL 'NODE-COMPLAIN 1>
		    <JUMP + PHRASE37>
PHRASE30
		    <TYPE? O28 <TYPE-CODE STRING> - PHRASE32>
		    <FRAME 'PRINC>
		    <PUSH O28>
		    <DEAD O28>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <JUMP + PHRASE37>
PHRASE32
		    <FRAME 'PRIN1>
		    <PUSH O28>
		    <DEAD O28>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2>
PHRASE37
		    <RESTL TEMP13 1 = TEMP13 (TYPE LIST)>
		    <JUMP + MAP17>
MAPAP20
		    <FRAME 'CRLF>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'CRLF 1>
		    <FRAME 'NODE-COMPLAIN>
		    <NTHL LL8 1 = STACK (TYPE NODE)>
		    <CALL 'NODE-COMPLAIN 1>
		    <RESTL LL8 1 = LL8 (TYPE LIST)>
		    <RESTL LL8 1 = LL8 (TYPE LIST)>
		    <JUMP + AGAIN9>
		    <END ANA-MESS>

#WORD *11256535325*
		    <GFCN ADDVMESS ("VALUE" LIST NODE LIST) N4 L5>
		    <TEMP TEMP8 V7:LIST TEMP17>
		    <INTGO>
		    <GEN-LVAL 'VERBOSE = V7>
		    <SET TEMP8 V7>
		    <EMPL? TEMP8 + PHRASE12>
		    <LOOP (N4 VALUE) (TEMP8 VALUE)>
TAG15
		    <NTHL TEMP8 1 = TEMP17>
		    <TYPE? TEMP17 <TYPE-CODE NODE> - TAG16>
		    <VEQUAL? TEMP17 N4 + TAG14>
		    <DEAD TEMP17>
TAG16
		    <RESTL TEMP8 1 = TEMP8 (TYPE LIST)>
		    <EMPL? TEMP8 - TAG15>
		    <JUMP + PHRASE12>
TAG14
		    <RESTL TEMP8 1 = TEMP17 (TYPE LIST)>
		    <DEAD TEMP8>
		    <NTHL TEMP17 1 = TEMP8 (TYPE LIST)>
		    <DEAD TEMP17>
		    <LENL TEMP8 = TEMP17 (TYPE FIX)>
		    <SUB TEMP17 -1 = TEMP17 (TYPE FIX)>
		    <GRTR? TEMP17 0 - RESTL20 (TYPE FIX)>
		    <LOOP (TEMP8 VALUE) (TEMP17 VALUE)>
RESTL18
		    <INTGO>
		    <RESTL TEMP8 1 = TEMP8 (TYPE LIST)>
		    <SUB TEMP17 1 = TEMP17 (TYPE FIX)>
		    <GRTR? TEMP17 0 + RESTL18 (TYPE FIX)>
RESTL20
		    <PUTREST TEMP8 L5>
		    <DEAD L5>
		    <RETURN TEMP8>
		    <DEAD TEMP8>
PHRASE12
		    <CONS L5 () = TEMP17>
		    <DEAD L5>
		    <CONS N4 TEMP17 = TEMP17>
		    <DEAD N4>
		    <PUTREST V7 TEMP17>
		    <DEAD TEMP17>
		    <RESTL V7 1 = TEMP17 (TYPE LIST)>
		    <DEAD V7>
		    <RESTL TEMP17 1 = TEMP8 (TYPE LIST)>
		    <DEAD TEMP17>
		    <GEN-SET 'VERBOSE TEMP8>
		    <RETURN TEMP8>
		    <DEAD TEMP8>
		    <END ADDVMESS>

#WORD *34156736513*
		    <GFCN COMPILE-ERROR ("VALUE" ANY "TUPLE" ANY)>
		    <MAKTUP X4 IT20 = X4>
		    <INTGO>
		    <FRAME 'PRINC>
		    <PUSH "*** ERROR ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <CHTYPE X4 <TYPE-CODE VECTOR> = X4>
		    <LOOP>
MAP10
		    <INTGO>
		    <EMPUV? X4 + MAPAP13>
		    <NTHUV X4 1 = IT20>
		    <TYPE? IT20 <TYPE-CODE STRING> - PHRASE22>
		    <FRAME 'PRINC>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <JUMP + PHRASE29>
PHRASE22
		    <TYPE? IT20 <TYPE-CODE NODE> - PHRASE27>
		    <FRAME 'NODE-COMPLAIN>
		    <PUSH IT20>
		    <DEAD IT20>
		    <CALL 'NODE-COMPLAIN 1>
		    <JUMP + PHRASE29>
PHRASE27
		    <FRAME 'PRIN1>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2>
PHRASE29
		    <FRAME 'PRINC>
		    <PUSH " ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <RESTUV X4 1 = X4 (TYPE VECTOR)>
		    <JUMP + MAP10>
MAPAP13
		    <NTHR 'DEBUGSW 1 = X4 (RECORD-TYPE ATOM) (BRANCH-FALSE + PHRASE39)>
		    <TYPE? X4 <TYPE-CODE FALSE> + PHRASE39>
		    <NTHR X4 1 = X4 (RECORD-TYPE GBIND)>
		    <TYPE? X4 <TYPE-CODE UNBOUND> + PHRASE39>
		    <DEAD X4>
		    <GVAL 'DEBUGSW = X4>
		    <TYPE? X4 <TYPE-CODE FALSE> + PHRASE39>
		    <DEAD X4>
		    <FRAME 'ERROR>
		    <CALL 'ERROR 0>
PHRASE39
		    <FRAME 'RETURN>
		    <PUSH %<>>
		    <GEN-LVAL 'COMPILE-ACTIVATION = STACK>
		    <CALL 'RETURN 2 = X4>
		    <RETURN X4>
		    <DEAD X4>
		    <END COMPILE-ERROR>

#WORD *1706511541*
		    <GFCN COMPILE-LOSSAGE ("VALUE" ANY "TUPLE" ANY)>
		    <MAKTUP X4 IT20 = X4>
		    <INTGO>
		    <FRAME 'PRINC>
		    <PUSH "*** LOSSAGE ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <CHTYPE X4 <TYPE-CODE VECTOR> = X4>
		    <LOOP>
MAP10
		    <INTGO>
		    <EMPUV? X4 + MAPAP13>
		    <NTHUV X4 1 = IT20>
		    <TYPE? IT20 <TYPE-CODE STRING> - PHRASE22>
		    <FRAME 'PRINC>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <JUMP + PHRASE29>
PHRASE22
		    <TYPE? IT20 <TYPE-CODE NODE> - PHRASE27>
		    <FRAME 'NODE-COMPLAIN>
		    <PUSH IT20>
		    <DEAD IT20>
		    <CALL 'NODE-COMPLAIN 1>
		    <JUMP + PHRASE29>
PHRASE27
		    <FRAME 'PRIN1>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2>
PHRASE29
		    <FRAME 'PRINC>
		    <PUSH " ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <RESTUV X4 1 = X4 (TYPE VECTOR)>
		    <JUMP + MAP10>
MAPAP13
		    <FRAME 'ERROR>
		    <PUSH 'LOSSAGE!-ERRORS>
		    <CALL 'ERROR 1 = X4>
		    <RETURN X4>
		    <DEAD X4>
		    <END COMPILE-LOSSAGE>

#WORD *33260646511*
		    <GFCN COMPILE-WARNING ("VALUE" ATOM "TUPLE" ANY)>
		    <MAKTUP X4 IT20 = X4>
		    <INTGO>
		    <FRAME 'PRINC>
		    <PUSH "*** WARNING ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <CHTYPE X4 <TYPE-CODE VECTOR> = X4>
		    <LOOP>
MAP10
		    <INTGO>
		    <EMPUV? X4 + MAPAP13>
		    <NTHUV X4 1 = IT20>
		    <TYPE? IT20 <TYPE-CODE STRING> - PHRASE22>
		    <FRAME 'PRINC>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <JUMP + PHRASE29>
PHRASE22
		    <TYPE? IT20 <TYPE-CODE NODE> - PHRASE27>
		    <FRAME 'NODE-COMPLAIN>
		    <PUSH IT20>
		    <DEAD IT20>
		    <CALL 'NODE-COMPLAIN 1>
		    <JUMP + PHRASE29>
PHRASE27
		    <FRAME 'PRIN1>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2>
PHRASE29
		    <FRAME 'PRINC>
		    <PUSH " ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <RESTUV X4 1 = X4 (TYPE VECTOR)>
		    <JUMP + MAP10>
MAPAP13
		    <FRAME 'CRLF>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'CRLF 1 = X4>
		    <RETURN X4>
		    <DEAD X4>
		    <END COMPILE-WARNING>

#WORD *35041035633*
		    <GFCN COMPILE-NOTE ("VALUE" ATOM "TUPLE" ANY)>
		    <MAKTUP X4 IT20 = X4>
		    <INTGO>
		    <FRAME 'PRINC>
		    <PUSH "*** NOTE ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <CHTYPE X4 <TYPE-CODE VECTOR> = X4>
		    <LOOP>
MAP10
		    <INTGO>
		    <EMPUV? X4 + MAPAP13>
		    <NTHUV X4 1 = IT20>
		    <TYPE? IT20 <TYPE-CODE STRING> - PHRASE22>
		    <FRAME 'PRINC>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <JUMP + PHRASE29>
PHRASE22
		    <TYPE? IT20 <TYPE-CODE NODE> - PHRASE27>
		    <FRAME 'NODE-COMPLAIN>
		    <PUSH IT20>
		    <DEAD IT20>
		    <CALL 'NODE-COMPLAIN 1>
		    <JUMP + PHRASE29>
PHRASE27
		    <FRAME 'PRIN1>
		    <PUSH IT20>
		    <DEAD IT20>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRIN1 2>
PHRASE29
		    <FRAME 'PRINC>
		    <PUSH " ">
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'PRINC 2>
		    <RESTUV X4 1 = X4 (TYPE VECTOR)>
		    <JUMP + MAP10>
MAPAP13
		    <FRAME 'CRLF>
		    <GEN-LVAL 'OUTCHAN = STACK>
		    <CALL 'CRLF 1 = X4>
		    <RETURN X4>
		    <DEAD X4>
		    <END COMPILE-NOTE>

<ENDPACKAGE>
